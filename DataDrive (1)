{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11455,"status":"ok","timestamp":1681772805157,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"Ipnm2UO_IfX9","outputId":"da5af500-3311-43bb-92bd-16da34bf6789"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting catboost\n","  Downloading catboost-1.1.1-cp39-none-manylinux1_x86_64.whl (76.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m76.6/76.6 MB\u001b[0m \u001b[31m12.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.9/dist-packages (from catboost) (1.22.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.9/dist-packages (from catboost) (1.10.1)\n","Requirement already satisfied: pandas>=0.24.0 in /usr/local/lib/python3.9/dist-packages (from catboost) (1.5.3)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.9/dist-packages (from catboost) (0.20.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.9/dist-packages (from catboost) (3.7.1)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.9/dist-packages (from catboost) (5.13.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.9/dist-packages (from catboost) (1.16.0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.9/dist-packages (from pandas>=0.24.0->catboost) (2022.7.1)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.9/dist-packages (from pandas>=0.24.0->catboost) (2.8.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (23.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (0.11.0)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (8.4.0)\n","Requirement already satisfied: importlib-resources>=3.2.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (5.12.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (3.0.9)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (1.0.7)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (1.4.4)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib->catboost) (4.39.3)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.9/dist-packages (from plotly->catboost) (8.2.2)\n","Requirement already satisfied: zipp>=3.1.0 in /usr/local/lib/python3.9/dist-packages (from importlib-resources>=3.2.0->matplotlib->catboost) (3.15.0)\n","Installing collected packages: catboost\n","Successfully installed catboost-1.1.1\n"]}],"source":["!pip install catboost\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AZ-Tlx8yAKyS"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from catboost import CatBoostRegressor, Pool\n","from sklearn.metrics import mean_squared_error"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":373},"executionInfo":{"elapsed":1097,"status":"ok","timestamp":1681775532437,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"9TYmTYWJEr_-","outputId":"fa6523bd-27db-4d03-fa91-f9aa0a7f9371"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-61-3278eea45cec>:1: DtypeWarning: Columns (140,172,254,257,275,306,343,358,373,374,461,635,641,642,643) have mixed types. Specify dtype option on import or set low_memory=False.\n","  train = pd.read_csv(\"/content/Train (2).csv\")\n","<ipython-input-61-3278eea45cec>:2: DtypeWarning: Columns (172,252,254,257,275,343,358,359,461,641,642,643) have mixed types. Specify dtype option on import or set low_memory=False.\n","  test = pd.read_csv(\"/content/Test (1).csv\")\n"]},{"output_type":"execute_result","data":{"text/plain":["       child_id  data_year  child_date  child_age child_enrolment_date  \\\n","0  ID_SYSJ2FM0D     2022.0  2022-02-03  59.000000                  NaN   \n","1  ID_J5BTFOZR3     2019.0         NaN  60.163933                  NaN   \n","2  ID_R00SN7AUD     2022.0  2022-03-11  69.000000                  NaN   \n","3  ID_BSSK60PAZ     2021.0  2021-10-13  53.000000           2020-01-15   \n","4  ID_IZTY6TC4D     2021.0  2021-10-13  57.000000           2021-10-13   \n","\n","   child_months_enrolment child_grant   child_years_in_programme  \\\n","0                     NaN         NaN                        NaN   \n","1                     NaN         NaN  1st year in the programme   \n","2                     NaN         NaN                        NaN   \n","3                    20.0          No  1st year in the programme   \n","4                     0.0         NaN      2nd year in programme   \n","\n","   child_height child_observe_attentive  ... obs_cooking_5 obs_cooking_6  \\\n","0           NaN               Sometimes  ...           NaN           NaN   \n","1    103.000000               Sometimes  ...           NaN           NaN   \n","2    108.400002                   Often  ...           NaN           NaN   \n","3     98.099998           Almost always  ...           NaN           NaN   \n","4    114.000000           Almost always  ...           0.0           0.0   \n","\n","  obs_heating_1  obs_heating_2 obs_heating_3 obs_heating_4  obs_heating_5  \\\n","0           NaN            NaN           NaN           NaN            NaN   \n","1           NaN            NaN           NaN           NaN            NaN   \n","2           NaN            NaN           NaN           NaN            NaN   \n","3           NaN            NaN           NaN           NaN            NaN   \n","4           1.0            0.0           0.0           0.0            0.0   \n","\n","  obs_heating_6 obs_heating_7     target  \n","0           NaN           NaN  51.500000  \n","1           NaN           NaN  55.869999  \n","2           NaN           NaN  47.520000  \n","3           NaN           NaN  58.599998  \n","4           0.0           0.0  76.599998  \n","\n","[5 rows x 679 columns]"],"text/html":["\n","  <div id=\"df-99bbf1a0-2de3-4db0-b095-5e49e2319774\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>child_id</th>\n","      <th>data_year</th>\n","      <th>child_date</th>\n","      <th>child_age</th>\n","      <th>child_enrolment_date</th>\n","      <th>child_months_enrolment</th>\n","      <th>child_grant</th>\n","      <th>child_years_in_programme</th>\n","      <th>child_height</th>\n","      <th>child_observe_attentive</th>\n","      <th>...</th>\n","      <th>obs_cooking_5</th>\n","      <th>obs_cooking_6</th>\n","      <th>obs_heating_1</th>\n","      <th>obs_heating_2</th>\n","      <th>obs_heating_3</th>\n","      <th>obs_heating_4</th>\n","      <th>obs_heating_5</th>\n","      <th>obs_heating_6</th>\n","      <th>obs_heating_7</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ID_SYSJ2FM0D</td>\n","      <td>2022.0</td>\n","      <td>2022-02-03</td>\n","      <td>59.000000</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>Sometimes</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>51.500000</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ID_J5BTFOZR3</td>\n","      <td>2019.0</td>\n","      <td>NaN</td>\n","      <td>60.163933</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1st year in the programme</td>\n","      <td>103.000000</td>\n","      <td>Sometimes</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>55.869999</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ID_R00SN7AUD</td>\n","      <td>2022.0</td>\n","      <td>2022-03-11</td>\n","      <td>69.000000</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>108.400002</td>\n","      <td>Often</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>47.520000</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ID_BSSK60PAZ</td>\n","      <td>2021.0</td>\n","      <td>2021-10-13</td>\n","      <td>53.000000</td>\n","      <td>2020-01-15</td>\n","      <td>20.0</td>\n","      <td>No</td>\n","      <td>1st year in the programme</td>\n","      <td>98.099998</td>\n","      <td>Almost always</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>58.599998</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ID_IZTY6TC4D</td>\n","      <td>2021.0</td>\n","      <td>2021-10-13</td>\n","      <td>57.000000</td>\n","      <td>2021-10-13</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>2nd year in programme</td>\n","      <td>114.000000</td>\n","      <td>Almost always</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>76.599998</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 679 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-99bbf1a0-2de3-4db0-b095-5e49e2319774')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-99bbf1a0-2de3-4db0-b095-5e49e2319774 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-99bbf1a0-2de3-4db0-b095-5e49e2319774');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":61}],"source":["train = pd.read_csv(\"/content/Train (2).csv\")\n","test = pd.read_csv(\"/content/Test (1).csv\")\n","train.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1211,"status":"ok","timestamp":1681775536385,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"26lUc8BUE0KW","outputId":"9df7d5b8-a801-415d-e0e2-c883499cec9b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["child_id                   0\n","data_year                  0\n","child_date              1821\n","child_age                  0\n","child_enrolment_date    5964\n","                        ... \n","obs_heating_4           6324\n","obs_heating_5           6324\n","obs_heating_6           6324\n","obs_heating_7           6324\n","target                     0\n","Length: 679, dtype: int64"]},"metadata":{},"execution_count":62}],"source":["train.isnull().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1681775537232,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"6y40ulbJFvYF","outputId":"5dfe8414-0b28-45f3-81e6-f556cc6b65f1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(8585, 679)"]},"metadata":{},"execution_count":63}],"source":[" train.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":691,"status":"ok","timestamp":1681775540316,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"itcWVr51FAUX","outputId":"d886d52e-7712-461c-a7d2-58aeec932d69"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["child_id                   0\n","data_year                  0\n","child_date               754\n","child_age                  0\n","child_enrolment_date    2568\n","                        ... \n","obs_heating_3           2712\n","obs_heating_4           2712\n","obs_heating_5           2712\n","obs_heating_6           2712\n","obs_heating_7           2712\n","Length: 678, dtype: int64"]},"metadata":{},"execution_count":64}],"source":["test.isnull().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1179,"status":"ok","timestamp":1681775544123,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"ZYrmMCcZFj9g","outputId":"07257a97-7e7d-4538-bd4b-76f8ce9fc6a8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3680, 678)"]},"metadata":{},"execution_count":65}],"source":[" test.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":733,"status":"ok","timestamp":1681775545519,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"5v3EE5wBFz7m","outputId":"85876d18-45a4-48f1-9384-742fe70ff46c"},"outputs":[{"output_type":"stream","name":"stdout","text":["There is 254 Class in: child_date\n","There is 535 Class in: child_enrolment_date\n","There is 4 Class in: child_grant\n","There is 4 Class in: child_years_in_programme\n","There is 4 Class in: child_observe_attentive\n","There is 4 Class in: child_observe_concentrated\n","There is 4 Class in: child_observe_diligent\n","There is 4 Class in: child_observe_interested\n","There is 2 Class in: child_gender\n","There is 1018 Class in: child_dob\n","There is 3 Class in: child_stunted\n","There is 4 Class in: child_age_group\n","There is 153 Class in: id_mn_best\n","There is 10 Class in: prov_best\n","There is 50 Class in: id_dc_best\n","There is 50 Class in: dc_best\n","There is 153 Class in: mn_best\n","There is 5 Class in: pra_free_play\n","There is 4 Class in: pra_free_play_outdoor\n","There is 31 Class in: pra_groupings\n","There is 2 Class in: pra_groupings_1\n","There is 2 Class in: pra_groupings_2\n","There is 2 Class in: pra_groupings_3\n","There is 2 Class in: pra_groupings_4\n","There is 2 Class in: pra_groupings_5\n","There is 3 Class in: pra_engaged\n","There is 4 Class in: pra_agency_choice\n","There is 4 Class in: pra_agency_explore\n","There is 4 Class in: pra_agency_questions\n","There is 4 Class in: pra_agency_understand\n","There is 4 Class in: pra_agency_play\n","There is 4 Class in: pra_agency_learn\n","There is 4 Class in: pra_agency_order\n","There is 8 Class in: pra_plans\n","There is 2 Class in: pra_plans_1\n","There is 2 Class in: pra_plans_2\n","There is 2 Class in: pra_plans_3\n","There is 2 Class in: pra_plans_0\n","There is 2 Class in: pra_ind\n","There is 2 Class in: pri_mobile\n","There is 2 Class in: pri_school\n","There is 2 Class in: pri_holidays\n","There is 15 Class in: pri_calc_time_open\n","There is 27 Class in: pri_calc_time_close\n","There is 3 Class in: pri_separate\n","There is 64 Class in: pri_language\n","There is 2 Class in: pri_language_1\n","There is 2 Class in: pri_language_2\n","There is 2 Class in: pri_language_3\n","There is 2 Class in: pri_language_4\n","There is 2 Class in: pri_language_5\n","There is 2 Class in: pri_language_6\n","There is 2 Class in: pri_language_7\n","There is 2 Class in: pri_language_8\n","There is 2 Class in: pri_language_9\n","There is 2 Class in: pri_language_10\n","There is 2 Class in: pri_language_11\n","There is 2 Class in: pri_language_97\n","There is 1 Class in: pri_toys\n","There is 2 Class in: pri_aftercare\n","There is 2 Class in: pri_fees\n","There is 2 Class in: pri_fees_free\n","There is 11 Class in: pri_facilities\n","There is 12 Class in: pri_land\n","There is 3 Class in: pri_bank\n","There is 2 Class in: pri_transport\n","There is 26 Class in: pri_meal\n","There is 2 Class in: pri_meal_1\n","There is 2 Class in: pri_meal_3\n","There is 2 Class in: pri_meal_4\n","There is 2 Class in: pri_meal_2\n","There is 5 Class in: pri_registered_partial\n","There is 5 Class in: pri_registered_programme\n","There is 2 Class in: pri_registered_npo\n","There is 5 Class in: pri_registered_dsd\n","There is 2 Class in: pri_subsidy\n","There is 2 Class in: pri_network\n","There is 2 Class in: pri_attendance_usual\n","There is 2 Class in: pri_precovid_attendance\n","There is 3 Class in: pri_kitchen\n","There is 2 Class in: pri_funding_6\n","There is 2 Class in: pri_funding_7\n","There is 2 Class in: pri_funding_donations\n","There is 2 Class in: pri_funding_97\n","There is 5 Class in: pri_attendance\n","There is 2 Class in: pri_meals\n","There is 4 Class in: teacher_social_peers\n","There is 4 Class in: teacher_social_nonaggressive\n","There is 4 Class in: teacher_social_cooperate\n","There is 4 Class in: teacher_social_assistance\n","There is 4 Class in: teacher_social_ideas\n","There is 4 Class in: teacher_social_initiative\n","There is 3 Class in: teacher_emotional_understand\n","There is 3 Class in: teacher_emotional_appropriate\n","There is 3 Class in: teacher_emotional_independent\n","There is 3 Class in: teacher_emotional_adjust\n","There is 3 Class in: teacher_emotional_confidence\n","There is 3 Class in: teacher_emotional_selfstarter\n","There is 2 Class in: teacher_social_met\n","There is 2 Class in: teacher_emotional_met\n","There is 2 Class in: teacher_selfcare_met\n","There is 2 Class in: hle_ind\n","There is 2 Class in: obs_firstaid\n","There is 2 Class in: obs_space\n","There is 167 Class in: obs_area\n","There is 2 Class in: obs_area_1\n","There is 2 Class in: obs_area_2\n","There is 2 Class in: obs_area_3\n","There is 2 Class in: obs_area_4\n","There is 2 Class in: obs_area_5\n","There is 2 Class in: obs_area_6\n","There is 2 Class in: obs_area_7\n","There is 2 Class in: obs_area_8\n","There is 2 Class in: obs_area_0\n","There is 1107 Class in: obs_materials\n","There is 2 Class in: obs_materials_1\n","There is 2 Class in: obs_materials_2\n","There is 2 Class in: obs_materials_3\n","There is 2 Class in: obs_materials_4\n","There is 2 Class in: obs_materials_5\n","There is 2 Class in: obs_materials_6\n","There is 2 Class in: obs_materials_7\n","There is 2 Class in: obs_materials_8\n","There is 2 Class in: obs_materials_9\n","There is 2 Class in: obs_materials_10\n","There is 2 Class in: obs_materials_11\n","There is 2 Class in: obs_materials_12\n","There is 2 Class in: obs_materials_13\n","There is 2 Class in: obs_materials_14\n","There is 2 Class in: obs_materials_15\n","There is 2 Class in: obs_materials_16\n","There is 2 Class in: obs_materials_17\n","There is 2 Class in: obs_materials_18\n","There is 2 Class in: obs_materials_19\n","There is 2 Class in: obs_materials_20\n","There is 2 Class in: obs_materials_97\n","There is 2 Class in: obs_materials_0\n","There is 2 Class in: obs_accessible\n","There is 2 Class in: obs_books\n","There is 2 Class in: obs_books_age\n","There is 7 Class in: obs_heating_census\n","There is 7 Class in: obs_lighting_census\n","There is 6 Class in: obs_cooking_census\n","There is 7 Class in: obs_water\n","There is 2 Class in: obs_potable\n","There is 15 Class in: obs_handwashing\n","There is 2 Class in: obs_handwashing_1\n","There is 2 Class in: obs_handwashing_2\n","There is 2 Class in: obs_handwashing_3\n","There is 2 Class in: obs_handwashing_0\n","There is 2 Class in: obs_handwashing_97\n","There is 46 Class in: obs_toilet\n","There is 2 Class in: obs_toilet_1\n","There is 2 Class in: obs_toilet_2\n","There is 2 Class in: obs_toilet_3\n","There is 2 Class in: obs_toilet_4\n","There is 2 Class in: obs_toilet_5\n","There is 2 Class in: obs_toilet_6\n","There is 2 Class in: obs_toilet_7\n","There is 2 Class in: obs_toilet_8\n","There is 2 Class in: obs_toilet_0\n","There is 2 Class in: obs_toilet_97\n","There is 2 Class in: obs_toilets_children\n","There is 2 Class in: obs_toilets_gender\n","There is 5 Class in: obs_building\n","There is 2 Class in: obs_shared\n","There is 2 Class in: obs_outdoor\n","There is 28 Class in: obs_equipment\n","There is 2 Class in: obs_equipment_0\n","There is 2 Class in: obs_equipment_1\n","There is 2 Class in: obs_equipment_2\n","There is 2 Class in: obs_equipment_3\n","There is 2 Class in: obs_equipment_4\n","There is 2 Class in: obs_equipment_5\n","There is 2 Class in: obs_equipment__1\n","There is 4 Class in: obs_condition_equipment\n","There is 2 Class in: obs_fence\n","There is 2 Class in: obs_gate\n","There is 2 Class in: obs_access\n","There is 2 Class in: obs_water_running\n","There is 9 Class in: id_prov\n","There is 3 Class in: grade_r\n","There is 2 Class in: professionals_practitioners\n","There is 3 Class in: certificate_registration_partial\n","There is 3 Class in: certificate_registration_program\n","There is 3 Class in: certificate_registration_npo\n","There is 3 Class in: certificate_register\n","There is 2 Class in: census\n","There is 2 Class in: urban\n","There is 4 Class in: phase_natemis\n","There is 12 Class in: language_child\n","There is 13 Class in: language_assessment\n","There is 4 Class in: facility_type\n","There is 2 Class in: sef_ind\n","There is 2 Class in: elp_ind\n","There is 2 Class in: gps_ind\n","There is 2 Class in: pre_covid\n","There is 2 Class in: quintile_used\n","There is 5 Class in: ses_cat\n","----------------------------------\n","We have 277 features\n","We have 199 categorical features\n","We have 401 features that have more than 6000 of missing values\n"]}],"source":["features = [] \n","cat_features = []\n","not_features = []\n","\n","for k in train.columns[1:]:\n","    if train[k].isnull().sum() < 6000:\n","        features.append(k)\n","        if train[k].dtype == 'O':\n","            cat_features.append(k)\n","            print('There is '+ str(len(train[k].value_counts()))+' Class in: ' +k)\n","    else:\n","        not_features.append(k)\n","\n","print('----------------------------------')\n","print('We have '+str(len(features)) + ' features')\n","print('We have '+str(len(cat_features)) + ' categorical features')\n","print('We have '+str(len(not_features)) + ' features that have more than 6000 of missing values')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KQVrw0saGbkS"},"outputs":[],"source":["train = train[features]\n","test  = test[features[:-1]]\n","train = train.fillna('')\n","test  = test.fillna('')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Luar4nlnGxu1"},"outputs":[],"source":["xtrain, xvalid, ytrain, yvalid = train_test_split(\n","    train[train.columns[:-1]],\n","    train[train.columns[-1]],\n","    test_size = 0.1,\n","    random_state = 42,\n","    shuffle = True\n",")"]},{"cell_type":"code","source":["xtest = test[features[:-1]]\n","train_dataset = Pool(data = xtrain, label = ytrain, cat_features=cat_features)\n","val_dataset   = Pool(data = xvalid, label = yvalid, cat_features=cat_features)\n","model         = CatBoostRegressor(iterations = 30000, learning_rate=0.01, random_seed=123, verbose=300)\n","model.fit(train_dataset, eval_set=val_dataset, use_best_model=True, early_stopping_rounds=3000)\n","preds_valid = model.predict(xvalid)\n","preds_test  = model.predict(xtest)\n","print(np.sqrt(mean_squared_error(yvalid, preds_valid)))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3FsbhzH6oqWE","outputId":"38f6e712-d1c7-455d-a781-85520bb7356f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["0:\tlearn: 15.0533732\ttest: 15.6413136\tbest: 15.6413136 (0)\ttotal: 430ms\tremaining: 3h 35m 2s\n","300:\tlearn: 11.2016675\ttest: 11.4670535\tbest: 11.4670535 (300)\ttotal: 2m 16s\tremaining: 3h 43m 45s\n","600:\tlearn: 10.6452172\ttest: 10.9626951\tbest: 10.9626951 (600)\ttotal: 4m 28s\tremaining: 3h 38m 47s\n","900:\tlearn: 10.2772769\ttest: 10.6861050\tbest: 10.6861050 (900)\ttotal: 6m 40s\tremaining: 3h 35m 22s\n","1200:\tlearn: 9.8978337\ttest: 10.4324044\tbest: 10.4324044 (1200)\ttotal: 8m 50s\tremaining: 3h 32m\n","1500:\tlearn: 9.6440609\ttest: 10.2704724\tbest: 10.2704565 (1499)\ttotal: 11m 4s\tremaining: 3h 30m 8s\n","1800:\tlearn: 9.4663560\ttest: 10.1806099\tbest: 10.1806099 (1800)\ttotal: 13m 17s\tremaining: 3h 28m\n","2100:\tlearn: 9.3251138\ttest: 10.1134701\tbest: 10.1134068 (2098)\ttotal: 15m 29s\tremaining: 3h 25m 47s\n","2400:\tlearn: 9.1909335\ttest: 10.0577786\tbest: 10.0577784 (2399)\ttotal: 17m 41s\tremaining: 3h 23m 20s\n","2700:\tlearn: 9.0838827\ttest: 10.0165136\tbest: 10.0165136 (2700)\ttotal: 19m 54s\tremaining: 3h 21m 8s\n","3000:\tlearn: 8.9825454\ttest: 9.9833817\tbest: 9.9832558 (2992)\ttotal: 22m 8s\tremaining: 3h 19m 8s\n","3300:\tlearn: 8.8814955\ttest: 9.9484796\tbest: 9.9484796 (3300)\ttotal: 24m 21s\tremaining: 3h 16m 58s\n","3600:\tlearn: 8.7881317\ttest: 9.9154799\tbest: 9.9154799 (3600)\ttotal: 26m 35s\tremaining: 3h 14m 57s\n","3900:\tlearn: 8.6972533\ttest: 9.8947384\tbest: 9.8943214 (3881)\ttotal: 28m 49s\tremaining: 3h 12m 48s\n","4200:\tlearn: 8.6119586\ttest: 9.8747368\tbest: 9.8744286 (4194)\ttotal: 31m 2s\tremaining: 3h 10m 35s\n","4500:\tlearn: 8.5303231\ttest: 9.8548657\tbest: 9.8548657 (4500)\ttotal: 33m 15s\tremaining: 3h 8m 23s\n","4800:\tlearn: 8.4496374\ttest: 9.8296485\tbest: 9.8296485 (4800)\ttotal: 35m 28s\tremaining: 3h 6m 9s\n","5100:\tlearn: 8.3726892\ttest: 9.8087815\tbest: 9.8077428 (5096)\ttotal: 37m 42s\tremaining: 3h 4m 3s\n","5400:\tlearn: 8.2953310\ttest: 9.7946881\tbest: 9.7946881 (5400)\ttotal: 40m 1s\tremaining: 3h 2m 18s\n","5700:\tlearn: 8.2193413\ttest: 9.7817697\tbest: 9.7817697 (5700)\ttotal: 42m 16s\tremaining: 3h 9s\n","6000:\tlearn: 8.1589345\ttest: 9.7707874\tbest: 9.7704971 (5979)\ttotal: 44m 35s\tremaining: 2h 58m 18s\n","6300:\tlearn: 8.0916122\ttest: 9.7617622\tbest: 9.7617499 (6295)\ttotal: 46m 57s\tremaining: 2h 56m 37s\n","6600:\tlearn: 8.0293065\ttest: 9.7526617\tbest: 9.7522260 (6556)\ttotal: 49m 26s\tremaining: 2h 55m 15s\n","6900:\tlearn: 7.9723240\ttest: 9.7460041\tbest: 9.7459538 (6887)\ttotal: 51m 44s\tremaining: 2h 53m 10s\n","7200:\tlearn: 7.9140912\ttest: 9.7381217\tbest: 9.7374071 (7176)\ttotal: 53m 59s\tremaining: 2h 50m 56s\n","7500:\tlearn: 7.8605391\ttest: 9.7310413\tbest: 9.7304317 (7462)\ttotal: 56m 12s\tremaining: 2h 48m 34s\n","7800:\tlearn: 7.8076021\ttest: 9.7251775\tbest: 9.7251775 (7800)\ttotal: 58m 25s\tremaining: 2h 46m 14s\n","8100:\tlearn: 7.7562038\ttest: 9.7151857\tbest: 9.7151733 (8097)\ttotal: 1h 35s\tremaining: 2h 43m 47s\n","8400:\tlearn: 7.7030667\ttest: 9.7112837\tbest: 9.7106099 (8388)\ttotal: 1h 2m 45s\tremaining: 2h 41m 21s\n","8700:\tlearn: 7.6527522\ttest: 9.7001437\tbest: 9.7000327 (8694)\ttotal: 1h 4m 55s\tremaining: 2h 38m 55s\n","9000:\tlearn: 7.6035368\ttest: 9.6929089\tbest: 9.6924761 (8992)\ttotal: 1h 7m 5s\tremaining: 2h 36m 31s\n","9300:\tlearn: 7.5534013\ttest: 9.6896114\tbest: 9.6888110 (9264)\ttotal: 1h 9m 17s\tremaining: 2h 34m 12s\n","9600:\tlearn: 7.5029955\ttest: 9.6807325\tbest: 9.6806905 (9576)\ttotal: 1h 11m 28s\tremaining: 2h 31m 51s\n","9900:\tlearn: 7.4565972\ttest: 9.6801955\tbest: 9.6780067 (9827)\ttotal: 1h 13m 40s\tremaining: 2h 29m 34s\n","10200:\tlearn: 7.4059190\ttest: 9.6751743\tbest: 9.6751743 (10200)\ttotal: 1h 15m 50s\tremaining: 2h 27m 12s\n","10500:\tlearn: 7.3586474\ttest: 9.6723491\tbest: 9.6723491 (10500)\ttotal: 1h 18m 3s\tremaining: 2h 24m 56s\n","10800:\tlearn: 7.3159381\ttest: 9.6687092\tbest: 9.6682326 (10699)\ttotal: 1h 20m 12s\tremaining: 2h 22m 34s\n","11100:\tlearn: 7.2725052\ttest: 9.6632344\tbest: 9.6632344 (11100)\ttotal: 1h 22m 23s\tremaining: 2h 20m 15s\n","11400:\tlearn: 7.2285311\ttest: 9.6576699\tbest: 9.6566746 (11358)\ttotal: 1h 24m 34s\tremaining: 2h 17m 57s\n","11700:\tlearn: 7.1852356\ttest: 9.6541661\tbest: 9.6540935 (11634)\ttotal: 1h 26m 49s\tremaining: 2h 15m 46s\n","12000:\tlearn: 7.1416543\ttest: 9.6546785\tbest: 9.6528366 (11823)\ttotal: 1h 29m 1s\tremaining: 2h 13m 31s\n","12300:\tlearn: 7.0972340\ttest: 9.6512376\tbest: 9.6512376 (12300)\ttotal: 1h 31m 13s\tremaining: 2h 11m 15s\n","12600:\tlearn: 7.0547949\ttest: 9.6482734\tbest: 9.6479002 (12598)\ttotal: 1h 33m 25s\tremaining: 2h 8m 59s\n","12900:\tlearn: 7.0096806\ttest: 9.6487643\tbest: 9.6475050 (12628)\ttotal: 1h 35m 36s\tremaining: 2h 6m 42s\n","13200:\tlearn: 6.9658688\ttest: 9.6471335\tbest: 9.6471080 (13198)\ttotal: 1h 37m 49s\tremaining: 2h 4m 29s\n","13500:\tlearn: 6.9240263\ttest: 9.6454429\tbest: 9.6448034 (13473)\ttotal: 1h 40m 6s\tremaining: 2h 2m 19s\n","13800:\tlearn: 6.8825089\ttest: 9.6429341\tbest: 9.6424576 (13778)\ttotal: 1h 42m 24s\tremaining: 2h 11s\n","14100:\tlearn: 6.8386962\ttest: 9.6397233\tbest: 9.6391069 (14007)\ttotal: 1h 44m 44s\tremaining: 1h 58m 5s\n","14400:\tlearn: 6.8002905\ttest: 9.6351042\tbest: 9.6346156 (14389)\ttotal: 1h 47m 1s\tremaining: 1h 55m 55s\n","14700:\tlearn: 6.7604279\ttest: 9.6330474\tbest: 9.6328327 (14619)\ttotal: 1h 49m 18s\tremaining: 1h 53m 45s\n","15000:\tlearn: 6.7176377\ttest: 9.6274455\tbest: 9.6274455 (15000)\ttotal: 1h 51m 36s\tremaining: 1h 51m 35s\n","15300:\tlearn: 6.6779224\ttest: 9.6248860\tbest: 9.6237592 (15197)\ttotal: 1h 53m 51s\tremaining: 1h 49m 22s\n","15600:\tlearn: 6.6367525\ttest: 9.6228258\tbest: 9.6223806 (15589)\ttotal: 1h 56m 6s\tremaining: 1h 47m 9s\n","15900:\tlearn: 6.6018535\ttest: 9.6242280\tbest: 9.6222046 (15665)\ttotal: 1h 58m 20s\tremaining: 1h 44m 56s\n","16200:\tlearn: 6.5645391\ttest: 9.6228030\tbest: 9.6222046 (15665)\ttotal: 2h 36s\tremaining: 1h 42m 43s\n","16500:\tlearn: 6.5261881\ttest: 9.6205216\tbest: 9.6203348 (16492)\ttotal: 2h 2m 51s\tremaining: 1h 40m 30s\n","16800:\tlearn: 6.4902358\ttest: 9.6193016\tbest: 9.6182133 (16759)\ttotal: 2h 5m 6s\tremaining: 1h 38m 17s\n","17100:\tlearn: 6.4562052\ttest: 9.6167779\tbest: 9.6165540 (17090)\ttotal: 2h 7m 22s\tremaining: 1h 36m 4s\n","17400:\tlearn: 6.4207250\ttest: 9.6146551\tbest: 9.6141456 (17340)\ttotal: 2h 9m 35s\tremaining: 1h 33m 49s\n","17700:\tlearn: 6.3851098\ttest: 9.6117569\tbest: 9.6115514 (17600)\ttotal: 2h 11m 51s\tremaining: 1h 31m 36s\n","18000:\tlearn: 6.3484751\ttest: 9.6111156\tbest: 9.6106752 (17819)\ttotal: 2h 14m 6s\tremaining: 1h 29m 23s\n","18300:\tlearn: 6.3150101\ttest: 9.6068659\tbest: 9.6067847 (18296)\ttotal: 2h 16m 22s\tremaining: 1h 27m 10s\n","18600:\tlearn: 6.2817767\ttest: 9.6067532\tbest: 9.6057911 (18553)\ttotal: 2h 18m 40s\tremaining: 1h 24m 59s\n","18900:\tlearn: 6.2487979\ttest: 9.6058643\tbest: 9.6051509 (18773)\ttotal: 2h 20m 58s\tremaining: 1h 22m 47s\n","19200:\tlearn: 6.2141932\ttest: 9.6040696\tbest: 9.6040644 (19135)\ttotal: 2h 23m 21s\tremaining: 1h 20m 37s\n","19500:\tlearn: 6.1826132\ttest: 9.6020268\tbest: 9.6020088 (19496)\ttotal: 2h 25m 36s\tremaining: 1h 18m 23s\n","19800:\tlearn: 6.1475153\ttest: 9.5969269\tbest: 9.5964668 (19780)\ttotal: 2h 27m 49s\tremaining: 1h 16m 8s\n","20100:\tlearn: 6.1133161\ttest: 9.5971060\tbest: 9.5964668 (19780)\ttotal: 2h 30m 2s\tremaining: 1h 13m 53s\n","20400:\tlearn: 6.0816538\ttest: 9.5957569\tbest: 9.5956024 (20370)\ttotal: 2h 32m 14s\tremaining: 1h 11m 38s\n","20700:\tlearn: 6.0489512\ttest: 9.5937068\tbest: 9.5925729 (20666)\ttotal: 2h 34m 26s\tremaining: 1h 9m 22s\n","21000:\tlearn: 6.0175904\ttest: 9.5925001\tbest: 9.5915904 (20946)\ttotal: 2h 36m 40s\tremaining: 1h 7m 8s\n","21300:\tlearn: 5.9829594\ttest: 9.5902902\tbest: 9.5900967 (21276)\ttotal: 2h 38m 55s\tremaining: 1h 4m 54s\n","21600:\tlearn: 5.9528292\ttest: 9.5880341\tbest: 9.5876734 (21585)\ttotal: 2h 41m 8s\tremaining: 1h 2m 39s\n","21900:\tlearn: 5.9218219\ttest: 9.5875772\tbest: 9.5867141 (21812)\ttotal: 2h 43m 20s\tremaining: 1h 24s\n","22200:\tlearn: 5.8900256\ttest: 9.5889781\tbest: 9.5867141 (21812)\ttotal: 2h 45m 35s\tremaining: 58m 10s\n","22500:\tlearn: 5.8589974\ttest: 9.5886011\tbest: 9.5867141 (21812)\ttotal: 2h 47m 50s\tremaining: 55m 56s\n","22800:\tlearn: 5.8289512\ttest: 9.5893102\tbest: 9.5867141 (21812)\ttotal: 2h 50m 2s\tremaining: 53m 41s\n","23100:\tlearn: 5.7997936\ttest: 9.5879296\tbest: 9.5867141 (21812)\ttotal: 2h 52m 17s\tremaining: 51m 27s\n","23400:\tlearn: 5.7690443\ttest: 9.5879878\tbest: 9.5867141 (21812)\ttotal: 2h 54m 32s\tremaining: 49m 13s\n","23700:\tlearn: 5.7383792\ttest: 9.5880816\tbest: 9.5865212 (23600)\ttotal: 2h 56m 46s\tremaining: 46m 58s\n","24000:\tlearn: 5.7104866\ttest: 9.5852966\tbest: 9.5852966 (24000)\ttotal: 2h 58m 59s\tremaining: 44m 44s\n","24300:\tlearn: 5.6818046\ttest: 9.5863823\tbest: 9.5849511 (24076)\ttotal: 3h 1m 12s\tremaining: 42m 29s\n","24600:\tlearn: 5.6514284\ttest: 9.5884182\tbest: 9.5849511 (24076)\ttotal: 3h 3m 27s\tremaining: 40m 15s\n","24900:\tlearn: 5.6244257\ttest: 9.5871703\tbest: 9.5849511 (24076)\ttotal: 3h 5m 38s\tremaining: 38m\n","25200:\tlearn: 5.5954557\ttest: 9.5859743\tbest: 9.5849511 (24076)\ttotal: 3h 7m 53s\tremaining: 35m 46s\n","25500:\tlearn: 5.5658416\ttest: 9.5847004\tbest: 9.5845538 (25494)\ttotal: 3h 10m 8s\tremaining: 33m 32s\n","25800:\tlearn: 5.5363489\ttest: 9.5825839\tbest: 9.5823456 (25777)\ttotal: 3h 12m 22s\tremaining: 31m 18s\n","26100:\tlearn: 5.5097178\ttest: 9.5824812\tbest: 9.5813138 (25933)\ttotal: 3h 14m 36s\tremaining: 29m 4s\n","26400:\tlearn: 5.4823756\ttest: 9.5841189\tbest: 9.5813138 (25933)\ttotal: 3h 16m 52s\tremaining: 26m 50s\n","26700:\tlearn: 5.4560269\ttest: 9.5841394\tbest: 9.5813138 (25933)\ttotal: 3h 19m 4s\tremaining: 24m 35s\n","27000:\tlearn: 5.4306386\ttest: 9.5841097\tbest: 9.5813138 (25933)\ttotal: 3h 21m 15s\tremaining: 22m 21s\n","27300:\tlearn: 5.4015418\ttest: 9.5826812\tbest: 9.5813138 (25933)\ttotal: 3h 23m 27s\tremaining: 20m 6s\n","27600:\tlearn: 5.3753890\ttest: 9.5817662\tbest: 9.5810153 (27424)\ttotal: 3h 25m 40s\tremaining: 17m 52s\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"LydrT0sPoraQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"qxK6Ak-Corjz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"eP43tvmCorra"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5558,"status":"ok","timestamp":1679871966256,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"aWXIWhlpK9L1","outputId":"f86f68a7-b07e-43b2-a900-cbd1cadd8057"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting shap\n","  Downloading shap-0.41.0-cp39-cp39-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (572 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m572.4/572.4 KB\u001b[0m \u001b[31m10.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.9/dist-packages (from shap) (1.22.4)\n","Requirement already satisfied: numba in /usr/local/lib/python3.9/dist-packages (from shap) (0.56.4)\n","Requirement already satisfied: tqdm>4.25.0 in /usr/local/lib/python3.9/dist-packages (from shap) (4.65.0)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.9/dist-packages (from shap) (1.2.2)\n","Requirement already satisfied: packaging>20.9 in /usr/local/lib/python3.9/dist-packages (from shap) (23.0)\n","Collecting slicer==0.0.7\n","  Downloading slicer-0.0.7-py3-none-any.whl (14 kB)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.9/dist-packages (from shap) (1.4.4)\n","Requirement already satisfied: cloudpickle in /usr/local/lib/python3.9/dist-packages (from shap) (2.2.1)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.9/dist-packages (from shap) (1.10.1)\n","Requirement already satisfied: llvmlite<0.40,>=0.39.0dev0 in /usr/local/lib/python3.9/dist-packages (from numba->shap) (0.39.1)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.9/dist-packages (from numba->shap) (67.6.0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.9/dist-packages (from pandas->shap) (2022.7.1)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.9/dist-packages (from pandas->shap) (2.8.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->shap) (3.1.0)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->shap) (1.1.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.9/dist-packages (from python-dateutil>=2.8.1->pandas->shap) (1.16.0)\n","Installing collected packages: slicer, shap\n","Successfully installed shap-0.41.0 slicer-0.0.7\n"]}],"source":["!pip install shap"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZZmRxWgBI5iT"},"outputs":[],"source":["import shap\n","expaliner = shap.TreeExplainer(model)\n","shap_values = expaliner.shap_values(xtest)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XJBg3uJANk5O"},"outputs":[],"source":["SampleSubmission = pd.read_csv(\"/content/SampleSubmission.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"anF6XKtBMoo7"},"outputs":[],"source":["features = xtest.columns"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a0-CLIipMowT"},"outputs":[],"source":["f = {\n","    'f1' : [], 'f2': [], 'f3': [], 'f4': [],'f5': [],\n","    'f6' : [], 'f7': [], 'f8': [], 'f9': [],'f10': [],\n","    'f11' : [], 'f12': [], 'f13': [], 'f14': [],'f15': []\n","}"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"j6omQhsmMuLG"},"outputs":[],"source":["for shap_value in shap_values:\n","    arr = np.argsort(shap_value)[::-1][:15]\n","    for ind, a in enumerate(arr):\n","        name_f = f'f{ind+1}'\n","        f[name_f].append(features[a])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tNiXfhghMuTI"},"outputs":[],"source":["SampleSubmission['target']    = preds_test\n","SampleSubmission['feature_1'] = f['f1']\n","SampleSubmission['feature_2'] = f['f2']\n","SampleSubmission['feature_3'] = f['f3']\n","SampleSubmission['feature_4'] = f['f4']\n","SampleSubmission['feature_5'] = f['f5']\n","SampleSubmission['feature_6'] = f['f6']\n","SampleSubmission['feature_7'] = f['f7']\n","SampleSubmission['feature_8'] = f['f8']\n","SampleSubmission['feature_9'] = f['f9']\n","SampleSubmission['feature_10'] = f['f10']\n","SampleSubmission['feature_11'] = f['f11']\n","SampleSubmission['feature_12'] = f['f12']\n","SampleSubmission['feature_13'] = f['f13']\n","SampleSubmission['feature_14'] = f['f14']\n","SampleSubmission['feature_15'] = f['f15']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aioYw_9CMuel"},"outputs":[],"source":["SampleSubmission.to_csv('submission3.csv', index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":483},"executionInfo":{"elapsed":430,"status":"ok","timestamp":1679872069395,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"mbeK5gA8Muwg","outputId":"3db21fd8-9c7d-4d0d-fec2-c12312fe9fc7"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-6f13a9ff-7380-442e-9445-0884d1ef2000\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>child_id</th>\n","      <th>target</th>\n","      <th>feature_1</th>\n","      <th>feature_2</th>\n","      <th>feature_3</th>\n","      <th>feature_4</th>\n","      <th>feature_5</th>\n","      <th>feature_6</th>\n","      <th>feature_7</th>\n","      <th>feature_8</th>\n","      <th>feature_9</th>\n","      <th>feature_10</th>\n","      <th>feature_11</th>\n","      <th>feature_12</th>\n","      <th>feature_13</th>\n","      <th>feature_14</th>\n","      <th>feature_15</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ID_0I0999N6S</td>\n","      <td>54.244118</td>\n","      <td>child_observe_diligent</td>\n","      <td>child_observe_attentive</td>\n","      <td>teacher_emotional_total</td>\n","      <td>child_observe_interested</td>\n","      <td>child_observe_total</td>\n","      <td>teacher_emotional_met</td>\n","      <td>ses_cat</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>teacher_emotional_independent</td>\n","      <td>child_age</td>\n","      <td>child_height</td>\n","      <td>ses_proxy</td>\n","      <td>teacher_social_peers</td>\n","      <td>child_observe_concentrated</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ID_GQ6ONJ4FP</td>\n","      <td>47.416030</td>\n","      <td>teacher_emotional_total</td>\n","      <td>child_observe_diligent</td>\n","      <td>child_observe_attentive</td>\n","      <td>child_observe_total</td>\n","      <td>child_observe_interested</td>\n","      <td>child_observe_concentrated</td>\n","      <td>teacher_emotional_met</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>teacher_emotional_independent</td>\n","      <td>teacher_social_peers</td>\n","      <td>teacher_emotional_confidence</td>\n","      <td>teacher_selfcare_met</td>\n","      <td>obs_toilet_1</td>\n","      <td>teacher_emotional_adjust</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ID_YZ76CVRW3</td>\n","      <td>48.712132</td>\n","      <td>child_observe_diligent</td>\n","      <td>id_mn_best</td>\n","      <td>child_observe_attentive</td>\n","      <td>child_observe_interested</td>\n","      <td>mn_best</td>\n","      <td>child_observe_total</td>\n","      <td>id_prov</td>\n","      <td>prov_best</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>teacher_emotional_independent</td>\n","      <td>dc_best</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>child_observe_concentrated</td>\n","      <td>id_dc_best</td>\n","      <td>teacher_social_peers</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ID_BNINCRXH8</td>\n","      <td>55.122994</td>\n","      <td>child_observe_diligent</td>\n","      <td>child_observe_attentive</td>\n","      <td>child_observe_total</td>\n","      <td>child_age</td>\n","      <td>child_observe_concentrated</td>\n","      <td>teacher_emotional_total</td>\n","      <td>child_observe_interested</td>\n","      <td>id_mn_best</td>\n","      <td>mn_best</td>\n","      <td>teacher_emotional_met</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>dc_best</td>\n","      <td>id_prov</td>\n","      <td>id_dc_best</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ID_1U7GDTLRI</td>\n","      <td>46.688838</td>\n","      <td>child_observe_diligent</td>\n","      <td>child_observe_interested</td>\n","      <td>child_observe_total</td>\n","      <td>prov_best</td>\n","      <td>child_observe_attentive</td>\n","      <td>id_prov</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>id_ward</td>\n","      <td>dc_best</td>\n","      <td>id_team</td>\n","      <td>latitude</td>\n","      <td>pri_attendance</td>\n","      <td>id_dc_best</td>\n","      <td>obs_materials</td>\n","      <td>pri_registered_npo</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3675</th>\n","      <td>ID_LBPQ2VMQZ</td>\n","      <td>55.965569</td>\n","      <td>child_age_group</td>\n","      <td>child_age</td>\n","      <td>child_observe_interested</td>\n","      <td>child_observe_attentive</td>\n","      <td>ses_proxy</td>\n","      <td>id_mn_best</td>\n","      <td>mn_best</td>\n","      <td>child_observe_total</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>child_observe_concentrated</td>\n","      <td>teacher_emotional_independent</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>id_prov</td>\n","      <td>prov_best</td>\n","      <td>teacher_social_peers</td>\n","    </tr>\n","    <tr>\n","      <th>3676</th>\n","      <td>ID_H2RKKMMKK</td>\n","      <td>49.854548</td>\n","      <td>child_age_group</td>\n","      <td>child_age</td>\n","      <td>child_height</td>\n","      <td>prov_best</td>\n","      <td>id_mn_best</td>\n","      <td>mn_best</td>\n","      <td>dc_best</td>\n","      <td>id_prov</td>\n","      <td>id_dc_best</td>\n","      <td>id_ward</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>teacher_emotional_independent</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>latitude</td>\n","      <td>id_team</td>\n","    </tr>\n","    <tr>\n","      <th>3677</th>\n","      <td>ID_VY8KX7YTZ</td>\n","      <td>48.854210</td>\n","      <td>child_observe_diligent</td>\n","      <td>child_observe_attentive</td>\n","      <td>child_observe_total</td>\n","      <td>child_age</td>\n","      <td>child_observe_interested</td>\n","      <td>child_observe_concentrated</td>\n","      <td>child_height</td>\n","      <td>teacher_emotional_selfstarter</td>\n","      <td>obs_materials</td>\n","      <td>teacher_emotional_independent</td>\n","      <td>teacher_emotional_confidence</td>\n","      <td>obs_equipment__1</td>\n","      <td>pri_holidays</td>\n","      <td>teacher_social_peers</td>\n","      <td>obs_firstaid</td>\n","    </tr>\n","    <tr>\n","      <th>3678</th>\n","      <td>ID_EO2MYZ4M7</td>\n","      <td>34.555930</td>\n","      <td>id_mn_best</td>\n","      <td>mn_best</td>\n","      <td>child_zha</td>\n","      <td>obs_materials</td>\n","      <td>id_dc_best</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>id_dc_n</td>\n","      <td>dc_best</td>\n","      <td>id_enumerator</td>\n","      <td>child_gender</td>\n","      <td>child_grant</td>\n","      <td>count_register_year_2020</td>\n","      <td>teacher_selfcare_total</td>\n","      <td>pri_holidays</td>\n","      <td>count_children_present</td>\n","    </tr>\n","    <tr>\n","      <th>3679</th>\n","      <td>ID_NSFLRZ8ZU</td>\n","      <td>45.874814</td>\n","      <td>child_age_group</td>\n","      <td>child_age</td>\n","      <td>prov_best</td>\n","      <td>id_mn_best</td>\n","      <td>mn_best</td>\n","      <td>dc_best</td>\n","      <td>id_ward</td>\n","      <td>id_prov</td>\n","      <td>id_dc_best</td>\n","      <td>latitude</td>\n","      <td>id_team</td>\n","      <td>longitude</td>\n","      <td>language_assessment</td>\n","      <td>teacher_emotional_understand</td>\n","      <td>ward_best</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3680 rows × 17 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6f13a9ff-7380-442e-9445-0884d1ef2000')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6f13a9ff-7380-442e-9445-0884d1ef2000 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6f13a9ff-7380-442e-9445-0884d1ef2000');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["          child_id     target                feature_1  \\\n","0     ID_0I0999N6S  54.244118   child_observe_diligent   \n","1     ID_GQ6ONJ4FP  47.416030  teacher_emotional_total   \n","2     ID_YZ76CVRW3  48.712132   child_observe_diligent   \n","3     ID_BNINCRXH8  55.122994   child_observe_diligent   \n","4     ID_1U7GDTLRI  46.688838   child_observe_diligent   \n","...            ...        ...                      ...   \n","3675  ID_LBPQ2VMQZ  55.965569          child_age_group   \n","3676  ID_H2RKKMMKK  49.854548          child_age_group   \n","3677  ID_VY8KX7YTZ  48.854210   child_observe_diligent   \n","3678  ID_EO2MYZ4M7  34.555930               id_mn_best   \n","3679  ID_NSFLRZ8ZU  45.874814          child_age_group   \n","\n","                     feature_2                 feature_3  \\\n","0      child_observe_attentive   teacher_emotional_total   \n","1       child_observe_diligent   child_observe_attentive   \n","2                   id_mn_best   child_observe_attentive   \n","3      child_observe_attentive       child_observe_total   \n","4     child_observe_interested       child_observe_total   \n","...                        ...                       ...   \n","3675                 child_age  child_observe_interested   \n","3676                 child_age              child_height   \n","3677   child_observe_attentive       child_observe_total   \n","3678                   mn_best                 child_zha   \n","3679                 child_age                 prov_best   \n","\n","                     feature_4                   feature_5  \\\n","0     child_observe_interested         child_observe_total   \n","1          child_observe_total    child_observe_interested   \n","2     child_observe_interested                     mn_best   \n","3                    child_age  child_observe_concentrated   \n","4                    prov_best     child_observe_attentive   \n","...                        ...                         ...   \n","3675   child_observe_attentive                   ses_proxy   \n","3676                 prov_best                  id_mn_best   \n","3677                 child_age    child_observe_interested   \n","3678             obs_materials                  id_dc_best   \n","3679                id_mn_best                     mn_best   \n","\n","                         feature_6                     feature_7  \\\n","0            teacher_emotional_met                       ses_cat   \n","1       child_observe_concentrated         teacher_emotional_met   \n","2              child_observe_total                       id_prov   \n","3          teacher_emotional_total      child_observe_interested   \n","4                          id_prov  teacher_emotional_understand   \n","...                            ...                           ...   \n","3675                    id_mn_best                       mn_best   \n","3676                       mn_best                       dc_best   \n","3677    child_observe_concentrated                  child_height   \n","3678  teacher_emotional_understand                       id_dc_n   \n","3679                       dc_best                       id_ward   \n","\n","                          feature_8                     feature_9  \\\n","0     teacher_emotional_selfstarter  teacher_emotional_understand   \n","1     teacher_emotional_selfstarter  teacher_emotional_understand   \n","2                         prov_best  teacher_emotional_understand   \n","3                        id_mn_best                       mn_best   \n","4                           id_ward                       dc_best   \n","...                             ...                           ...   \n","3675            child_observe_total  teacher_emotional_understand   \n","3676                        id_prov                    id_dc_best   \n","3677  teacher_emotional_selfstarter                 obs_materials   \n","3678                        dc_best                 id_enumerator   \n","3679                        id_prov                    id_dc_best   \n","\n","                         feature_10                     feature_11  \\\n","0     teacher_emotional_independent                      child_age   \n","1     teacher_emotional_independent           teacher_social_peers   \n","2     teacher_emotional_independent                        dc_best   \n","3             teacher_emotional_met   teacher_emotional_understand   \n","4                           id_team                       latitude   \n","...                             ...                            ...   \n","3675     child_observe_concentrated  teacher_emotional_independent   \n","3676                        id_ward   teacher_emotional_understand   \n","3677  teacher_emotional_independent   teacher_emotional_confidence   \n","3678                   child_gender                    child_grant   \n","3679                       latitude                        id_team   \n","\n","                         feature_12                     feature_13  \\\n","0                      child_height                      ses_proxy   \n","1      teacher_emotional_confidence           teacher_selfcare_met   \n","2     teacher_emotional_selfstarter     child_observe_concentrated   \n","3     teacher_emotional_selfstarter                        dc_best   \n","4                    pri_attendance                     id_dc_best   \n","...                             ...                            ...   \n","3675  teacher_emotional_selfstarter                        id_prov   \n","3676  teacher_emotional_independent  teacher_emotional_selfstarter   \n","3677               obs_equipment__1                   pri_holidays   \n","3678       count_register_year_2020         teacher_selfcare_total   \n","3679                      longitude            language_assessment   \n","\n","                        feature_14                  feature_15  \n","0             teacher_social_peers  child_observe_concentrated  \n","1                     obs_toilet_1    teacher_emotional_adjust  \n","2                       id_dc_best        teacher_social_peers  \n","3                          id_prov                  id_dc_best  \n","4                    obs_materials          pri_registered_npo  \n","...                            ...                         ...  \n","3675                     prov_best        teacher_social_peers  \n","3676                      latitude                     id_team  \n","3677          teacher_social_peers                obs_firstaid  \n","3678                  pri_holidays      count_children_present  \n","3679  teacher_emotional_understand                   ward_best  \n","\n","[3680 rows x 17 columns]"]},"execution_count":46,"metadata":{},"output_type":"execute_result"}],"source":["SampleSubmission"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uUbmRM2uVn-m"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2ZV4bD9FVoPx"},"outputs":[],"source":["y = np.array(train.target)\n","num_col = list(set(test.select_dtypes(\"number\")).intersection(train.select_dtypes(\"number\")))"]},{"cell_type":"code","source":["train = train[num_col]\n","x = train.fillna(0)\n","\n","test = test[num_col]\n","test = test.fillna(0)"],"metadata":{"id":"Y7fcuwc6fB9V"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Elw1d8ERfCKG","executionInfo":{"status":"ok","timestamp":1681774987749,"user_tz":-60,"elapsed":20,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"}},"outputId":"a2cf2374-57e8-4b7e-cca6-08a0bc8b51d2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3680, 159)"]},"metadata":{},"execution_count":47}]},{"cell_type":"code","source":["test.isna().sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zw-FW-12jqr7","executionInfo":{"status":"ok","timestamp":1681774990241,"user_tz":-60,"elapsed":1095,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"}},"outputId":"7a8a6092-7824-4f31-f702-eb1c2a9879d6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["pri_time_open_minutes          0\n","count_register_race            0\n","count_staff_gender             0\n","count_staff_paid_managers      0\n","pra_class_size                 0\n","                              ..\n","pri_fees_amount                0\n","pra_measure_rectangle_width    0\n","count_register_race_other      0\n","count_register_year_grader     0\n","pri_covid_staff_retrench       0\n","Length: 159, dtype: int64"]},"metadata":{},"execution_count":48}]},{"cell_type":"code","source":[],"metadata":{"id":"9ur2UHp2jq5l"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.preprocessing import StandardScaler"],"metadata":{"id":"UnLHGJ5XgQ-i"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=3)"],"metadata":{"id":"Y-W01qBVfCTx"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jA3FnMnZONzJ"},"outputs":[],"source":["sc = StandardScaler()\n","x_train = pd.DataFrame(sc.fit_transform(x_train))\n","x_test = pd.DataFrame(sc.fit_transform(x_test))\n","test_df = sc.fit_transform(test)"]},{"cell_type":"code","source":["x_train.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rKtEMn7XjOmx","executionInfo":{"status":"ok","timestamp":1681774999940,"user_tz":-60,"elapsed":33,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"}},"outputId":"cfaf4077-8c79-490b-e614-2c0f7d00337f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(6868, 159)"]},"metadata":{},"execution_count":52}]},{"cell_type":"code","source":["y_train.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bFEhbQZrjO0F","executionInfo":{"status":"ok","timestamp":1681774999945,"user_tz":-60,"elapsed":34,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"}},"outputId":"0548b61a-12eb-4039-9d91-7259a6b64a7d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(6868, 1)"]},"metadata":{},"execution_count":53}]},{"cell_type":"code","source":["pip install lightgbm "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"B-12GKLDehTJ","executionInfo":{"status":"ok","timestamp":1681774085978,"user_tz":-60,"elapsed":7213,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"}},"outputId":"ffbba9f5-c5f0-4aeb-cb84-f85a436fb733"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: lightgbm in /usr/local/lib/python3.9/dist-packages (3.3.5)\n","Requirement already satisfied: wheel in /usr/local/lib/python3.9/dist-packages (from lightgbm) (0.40.0)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.9/dist-packages (from lightgbm) (1.10.1)\n","Requirement already satisfied: scikit-learn!=0.22.0 in /usr/local/lib/python3.9/dist-packages (from lightgbm) (1.2.2)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.9/dist-packages (from lightgbm) (1.22.4)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn!=0.22.0->lightgbm) (3.1.0)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.9/dist-packages (from scikit-learn!=0.22.0->lightgbm) (1.2.0)\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"gYKTGUtQehbz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"nPNrnzC8j_lP"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyNzWge2FnlxOmg+qfNJLhps"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}